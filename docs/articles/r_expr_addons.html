<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R Expression Add-ons • dipsaus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="R Expression Add-ons">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dipsaus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/async_evaluator.html">Asynchronous Evaluator</a>
    </li>
    <li>
      <a href="../articles/r_expr_addons.html">R Expression Add-ons</a>
    </li>
    <li>
      <a href="../articles/shiny_customized_widgets.html">Shiny Customized Widgets</a>
    </li>
    <li>
      <a href="../articles/utility_functions.html">Utility Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dipterix/dipsaus">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>R Expression Add-ons</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dipterix/dipsaus/blob/master/vignettes/r_expr_addons.Rmd"><code>vignettes/r_expr_addons.Rmd</code></a></small>
      <div class="hidden name"><code>r_expr_addons.Rmd</code></div>

    </div>

    
    
<div id="assign-if-invalid" class="section level3">
<h3 class="hasAnchor">
<a href="#assign-if-invalid" class="anchor"></a>1. <code>%?&lt;-%</code>: Assign if invalid</h3>
<p>When coding in R, the data checking is actually a headache. For example, to check if a variable <code>aa</code> exists and not <code>NULL</code>, otherwise set a default value to be 1, the check looks like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="cf">if</span>( <span class="kw"><a href="https://rdrr.io/r/base/exists.html">exists</a></span>(<span class="st">'aa'</span>) <span class="op">&amp;&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(aa) ){</a>
<a class="sourceLine" id="cb1-2" title="2">  aa &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1-3" title="3">}</a></code></pre></div>
<p>Most of time we are repeating ourselves. With <code><a href="../reference/grapes-help-set-grapes.html">%?&lt;-%</a></code> operator, we just need:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">aa <span class="op">%?&lt;-%</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(aa)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>The powerful part is the left-hand side can be any expression. For example,</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">l <span class="op">%?&lt;-%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">l<span class="op">$</span>aa <span class="op">%?&lt;-%</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(l)</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; $aa</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; [1] 1</span></a></code></pre></div>
<p>If the value exists, then <code><a href="../reference/grapes-help-set-grapes.html">%?&lt;-%</a></code> does nothing (not even evaluate the expressions on the right-hand side)</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># e already exists</span></a>
<a class="sourceLine" id="cb4-2" title="2">e &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">aa =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># %?&lt;-% will not evaluate rhs, nor assign values</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw"><a href="https://rdrr.io/r/base/system.time.html">system.time</a></span>({</a>
<a class="sourceLine" id="cb4-6" title="6">  e <span class="op">%?&lt;-%</span><span class="st"> </span>{ <span class="kw"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="dv">10</span>); <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">aa =</span> <span class="dv">2</span>) }</a>
<a class="sourceLine" id="cb4-7" title="7">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(e)</a>
<a class="sourceLine" id="cb4-8" title="8">})</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="co">#&gt; $aa</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt;    user  system elapsed </span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt;       0       0       0</span></a></code></pre></div>
</div>
<div id="javascript-style-of-creating-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#javascript-style-of-creating-functions" class="anchor"></a>2. JavaScript-style of creating functions</h3>
<p>In modern JavaScript, function can be created via <code>(arg) =&gt; { ... }</code>. For example,</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> li <span class="op">=</span> [<span class="st">'A'</span><span class="op">,</span> <span class="st">'T'</span><span class="op">,</span> <span class="st">'G'</span><span class="op">,</span> <span class="st">'C'</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="va">li</span>.<span class="at">map</span>((el<span class="op">,</span> ii) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="cf">return</span>(<span class="vs">`The index for </span><span class="sc">${</span>el<span class="sc">}</span><span class="vs"> is </span><span class="sc">${</span>ii<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<script type="text/javascript">
const li = ['A', 'T', 'G', 'C'];
li.map((el, ii) => {
  return(`The index for ${el} is ${ii}`);
});
</script><p><code>dipsaus</code> provides functions <code>iapply</code>, and <code><a href="../reference/grapes-equals-greater-than-grapes.html">%=&gt;%</a></code>, together with <code>glue</code> package, we can apply elements like this:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># gl &lt;- glue::glue</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co"># `%&gt;%` &lt;- magrittr::`%&gt;%`</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4">li &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'A'</span>, <span class="st">'T'</span>, <span class="st">'G'</span>, <span class="st">'C'</span>)</a>
<a class="sourceLine" id="cb6-5" title="5">li <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/iapply.html">iapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(el, ii) <span class="op">%=&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="kw"><a href="https://rdrr.io/r/base/gl.html">gl</a></span>(<span class="st">'The index for {el} is {ii}'</span>)</a>
<a class="sourceLine" id="cb6-7" title="7">})</a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt; [1] "The index for A is 1" "The index for T is 2" "The index for G is 3"</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; [4] "The index for C is 4"</span></a></code></pre></div>
<p><code><a href="../reference/grapes-equals-greater-than-grapes.html">%=&gt;%</a></code> collect the left-hand side elements as arguments and right-hand side expression as body and create function:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(a, <span class="dt">b=</span>a<span class="op">^</span><span class="dv">2</span>, ...) <span class="op">%=&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(a , b,...))</a>
<a class="sourceLine" id="cb7-3" title="3">}</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; function (a, b = a^2, ...) </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; {</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt;     print(c(a, b, ...))</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; }</span></a></code></pre></div>
</div>
<div id="match-nested-calls-match_calls" class="section level3">
<h3 class="hasAnchor">
<a href="#match-nested-calls-match_calls" class="anchor"></a>3. Match nested calls <code>match_calls</code>
</h3>
<p>The function <code>match.call</code> provided by base package let us format calls with formals matched.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/match.call.html">match.call</a></span>(textInput, <span class="dt">call =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="kw">textInput</span>(<span class="st">'inputId'</span>, <span class="st">'label'</span>, <span class="st">'aaa'</span>)))</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; textInput(inputId = "inputId", label = "label", value = "aaa")</span></a></code></pre></div>
<p>This is already powerful as we can parse the expressions using <code><a href="https://rdrr.io/r/base/list.html">as.list()</a></code> to get the input parameters. However, when encounter the nested calls like <code>shiny</code> UI components, <code>match.call</code> does not work well. We can’t see the matched results inside of the nested functions.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/match.call.html">match.call</a></span>(tagList, <span class="dt">call =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(<span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="kw">div</span>(</a>
<a class="sourceLine" id="cb9-3" title="3">    tags<span class="op">$</span><span class="kw">ul</span>(</a>
<a class="sourceLine" id="cb9-4" title="4">      tags<span class="op">$</span><span class="kw">li</span>(<span class="kw">textInput</span>(<span class="st">'inputId'</span>, <span class="st">'label'</span>, <span class="st">'aaa'</span>))</a>
<a class="sourceLine" id="cb9-5" title="5">    )</a>
<a class="sourceLine" id="cb9-6" title="6">  )</a>
<a class="sourceLine" id="cb9-7" title="7">)))</a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">#&gt; tagList(div(tags$ul(tags$li(textInput("inputId", "label", "aaa")))))</span></a></code></pre></div>
<p><code>match_calls</code> solves this problem by recursively calling <code>match.call</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/match_calls.html">match_calls</a></span>(<span class="dt">call =</span> <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="kw">div</span>(</a>
<a class="sourceLine" id="cb10-3" title="3">    tags<span class="op">$</span><span class="kw">ul</span>(</a>
<a class="sourceLine" id="cb10-4" title="4">      tags<span class="op">$</span><span class="kw">li</span>(<span class="kw">textInput</span>(<span class="st">'inputId'</span>, <span class="st">'label'</span>, <span class="st">'aaa'</span>))</a>
<a class="sourceLine" id="cb10-5" title="5">    )</a>
<a class="sourceLine" id="cb10-6" title="6">  )</a>
<a class="sourceLine" id="cb10-7" title="7">), <span class="dt">recursive =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-8" title="8"><span class="co">#&gt; tagList(div(tags$ul(tags$li(textInput(inputId = "inputId", label = "label", </span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co">#&gt;     value = "aaa")))))</span></a></code></pre></div>
<p>It can also change modify the calls. For example, we want to add <code>ns</code> to input ID in shiny modules, then the following <code>replave_args</code> changes <code>"inputId"</code> to <code>ns("inputId")</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="../reference/match_calls.html">match_calls</a></span>(<span class="dt">call =</span> <span class="kw">tagList</span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="kw">div</span>(</a>
<a class="sourceLine" id="cb11-3" title="3">    tags<span class="op">$</span><span class="kw">ul</span>(</a>
<a class="sourceLine" id="cb11-4" title="4">      tags<span class="op">$</span><span class="kw">li</span>(<span class="kw">textInput</span>(<span class="st">'inputId'</span>, <span class="st">'label'</span>, <span class="st">'aaa'</span>))</a>
<a class="sourceLine" id="cb11-5" title="5">    )</a>
<a class="sourceLine" id="cb11-6" title="6">  )</a>
<a class="sourceLine" id="cb11-7" title="7">), <span class="dt">recursive =</span> <span class="ot">TRUE</span>, <span class="dt">replace_args =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb11-8" title="8">  <span class="st">'inputId'</span> =<span class="st"> </span><span class="cf">function</span>(v, ...){</a>
<a class="sourceLine" id="cb11-9" title="9">    <span class="kw"><a href="https://rdrr.io/r/base/call.html">as.call</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(ns), v))</a>
<a class="sourceLine" id="cb11-10" title="10">  }</a>
<a class="sourceLine" id="cb11-11" title="11">))</a>
<a class="sourceLine" id="cb11-12" title="12"><span class="co">#&gt; tagList(div(tags$ul(tags$li(textInput(inputId = ns("inputId"), </span></a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co">#&gt;     label = "label", value = "aaa")))))</span></a></code></pre></div>
</div>
<div id="pipe-friendly-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#pipe-friendly-functions" class="anchor"></a>4. Pipe-friendly functions</h3>
<p>Pipe functions can simplify the workflow and make R code more readable. The most popular pipe <code>%&gt;%</code> allows the left-hand elements to be the first input of the right-hand side functions. <code>dipsaus</code> provides several pipe-friendly functions.</p>
<div id="no-operations-no_op" class="section level4">
<h4 class="hasAnchor">
<a href="#no-operations-no_op" class="anchor"></a>No-operations <code>no_op</code>
</h4>
<p><code>no_op</code> takes whatever input in, and returns the input, with side effects. For example, we want to plot the results from the pipe and continue the analysis, usually this is what happens:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">do_something</span>(...) -&gt;</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span>x_tmp</a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x_tmp)</a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7">x_tmp <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="st">  </span><span class="kw">do_others</span>(...) -&gt;</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="st">  </span>final_results</a></code></pre></div>
<p>With <code>no_op</code>, the pipe becomes:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">x <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">do_something</span>(...) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/no_op.html">no_op</a></span>(plot, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="st">  </span><span class="kw">do_others</span>(...) -&gt;</a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span>final_results</a></code></pre></div>
<p>Here’s an example</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4">(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="st">  </span><span class="kw"><a href="../reference/iapply.html">iapply</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(el, ii) <span class="op">%=&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb14-6" title="6">    <span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(<span class="dv">20</span>, el, ii)</a>
<a class="sourceLine" id="cb14-7" title="7">  }, <span class="dt">simplify =</span> <span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="st">  </span>unlist <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="st">  </span><span class="co"># Begin no-ops, result will not change</span></a>
<a class="sourceLine" id="cb14-11" title="11"><span class="st">  </span><span class="kw"><a href="../reference/no_op.html">no_op</a></span>({</a>
<a class="sourceLine" id="cb14-12" title="12">    <span class="co"># Use expression and "." to refer the data</span></a>
<a class="sourceLine" id="cb14-13" title="13">    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(.))</a>
<a class="sourceLine" id="cb14-14" title="14">  }) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-15" title="15"><span class="st">  </span><span class="kw"><a href="../reference/no_op.html">no_op</a></span>(</a>
<a class="sourceLine" id="cb14-16" title="16">    <span class="co"># Use function and pass ... to function</span></a>
<a class="sourceLine" id="cb14-17" title="17">    plot, <span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dt">length.out =</span> <span class="dv">200</span>), </a>
<a class="sourceLine" id="cb14-18" title="18">    <span class="dt">type =</span> <span class="st">'p'</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">20</span>,<span class="dv">20</span>), <span class="dt">pch =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb14-19" title="19">    <span class="dt">xlab =</span> <span class="st">'Time'</span>, <span class="dt">ylab =</span> <span class="st">'Value'</span>, <span class="dt">las =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb14-20" title="20">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-21" title="21"><span class="st">  </span><span class="kw"><a href="../reference/no_op.html">no_op</a></span>(hist, <span class="dt">xlab =</span> <span class="st">'Values'</span>, <span class="dt">main =</span> <span class="st">'Histogram'</span>) -&gt;</a>
<a class="sourceLine" id="cb14-22" title="22"><span class="st">  </span>result</a>
<a class="sourceLine" id="cb14-23" title="23"><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></a>
<a class="sourceLine" id="cb14-24" title="24"><span class="co">#&gt; -9.0858  0.9602  4.1531  5.8707 10.4498 23.2076</span></a></code></pre></div>
<p><img src="r_expr_addons_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(result)</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="co">#&gt;  num [1:200] 1.896 0.406 -0.538 2.107 0.359 ...</span></a></code></pre></div>
</div>
<div id="do_aggregate" class="section level4">
<h4 class="hasAnchor">
<a href="#do_aggregate" class="anchor"></a><code>do_aggregate</code>
</h4>
<p>This is a wrapper of <code>aggregate</code> function. When using formula, <code>aggregate</code> requires the formula to be the first element. If the pipe results are <code>data.frame</code> and we want to use formula, it’s super inconvenient.</p>
<pre><code><a href="https://rdrr.io/r/stats/aggregate.html">## S3 method for class 'formula'
aggregate(formula, data, FUN, ..., subset, na.action = na.omit)</a></code></pre>
<p><code>do_aggregate</code> allows the first element to be data frames while using formula:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">ToothGrowth <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span><span class="kw"><a href="../reference/do_aggregate.html">do_aggregate</a></span>(len <span class="op">~</span><span class="st"> </span>., mean)</a>
<a class="sourceLine" id="cb17-3" title="3"><span class="co">#&gt;   supp dose   len</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="co">#&gt; 1   OJ  0.5 13.23</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">#&gt; 2   VC  0.5  7.98</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt; 3   OJ  1.0 22.70</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="co">#&gt; 4   VC  1.0 16.77</span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="co">#&gt; 5   OJ  2.0 26.06</span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="co">#&gt; 6   VC  2.0 26.14</span></a></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zhengjia Wang.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
