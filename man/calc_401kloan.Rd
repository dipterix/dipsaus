% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc-401kloan.R
\name{calc_401kloan}
\alias{calc_401kloan}
\title{Calculate optimal 401k loan strategy}
\usage{
calc_401kloan(
  loan_amount,
  k401_balance,
  cash_balance,
  k401_yield,
  cash_yield,
  k401_loan_apr,
  market_loan_apr,
  down_payment_pct = 0,
  n_months = 60,
  tax_rate = 0.22,
  early_withdrawal_penalty = 0.1
)
}
\arguments{
\item{loan_amount}{numeric; total amount of loan needed}

\item{k401_balance}{numeric; current balance in 401k retirement account}

\item{cash_balance}{numeric; current cash balance available}

\item{k401_yield}{numeric; 401k average annual yield (as decimal, e.g., 0.07 for 7\%)}

\item{cash_yield}{numeric; cash/savings annual yield (as decimal, e.g., 0.02 for 2\%)}

\item{k401_loan_apr}{numeric; 401k loan annual percentage rate (as decimal)}

\item{market_loan_apr}{numeric; market loan annual percentage rate (as decimal)}

\item{down_payment_pct}{numeric; down payment percentage for market loan (as decimal, default 0)}

\item{n_months}{integer; number of months for the loan (default 60)}

\item{tax_rate}{numeric; tax rate for early withdrawal (as decimal, default 0.22)}

\item{early_withdrawal_penalty}{numeric; early withdrawal penalty (as decimal, default 0.10)}
}
\value{
A list containing:
\itemize{
  \item \code{inputs}: list of all input parameters
  \item \code{recommended_401k_loan}: recommended amount to loan from 401k
  \item \code{recommended_market_loan}: recommended amount to loan from market
  \item \code{strategy}: recommended strategy ("401k_only", "market_only", or "mixed")
  \item \code{final_401k_balance}: expected 401k balance after n_months
  \item \code{final_cash_balance}: expected cash balance after n_months
  \item \code{total_final_balance}: sum of final balances
  \item \code{details}: detailed breakdown of calculations
}
}
\description{
Calculates the best strategy for obtaining loans from 401k retirement accounts
versus market loans. The function compares two strategies:
\enumerate{
  \item Taking a loan from 401k (paid back monthly with interest, money reinvests at 401k yield)
  \item Taking a market loan with down payment (cash grows but interest payments are lost)
}
}
\details{
The function calculates and compares multiple scenarios:

\strong{401k Loan Strategy:}
\itemize{
  \item Money borrowed from 401k reduces the balance
  \item Monthly payments (principal + interest) go back into 401k
  \item Remaining 401k balance continues to grow at 401k_yield rate
  \item Cash is preserved and grows at cash_yield rate
}

\strong{Market Loan Strategy:}
\itemize{
  \item Requires down payment from cash
  \item Monthly payments (principal + interest) reduce cash balance
  \item Full 401k balance continues to grow at 401k_yield rate
  \item Remaining cash grows at cash_yield rate
}

The function considers tax implications and early withdrawal penalties when
comparing strategies. It recommends the strategy that maximizes total final
balance (401k + cash) after the loan period.
}
\examples{
# Basic example: $50,000 loan with typical parameters
result <- calc_401kloan(
  loan_amount = 50000,
  k401_balance = 200000,
  cash_balance = 30000,
  k401_yield = 0.07,
  cash_yield = 0.02,
  k401_loan_apr = 0.045,
  market_loan_apr = 0.06
)
print(result$strategy)
print(result$total_final_balance)

# With down payment requirement
result2 <- calc_401kloan(
  loan_amount = 50000,
  k401_balance = 200000,
  cash_balance = 30000,
  k401_yield = 0.07,
  cash_yield = 0.02,
  k401_loan_apr = 0.045,
  market_loan_apr = 0.06,
  down_payment_pct = 0.20,
  n_months = 60
)

}
